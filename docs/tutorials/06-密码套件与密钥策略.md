# 文章 6 — 密码套件与密钥策略

学习目标：根据业务与合规需求选择合适的 Cipher Suite，制定安全与可用性的平衡策略。

## 6.1 标准套件概览

- GCM-AES-128：默认套件，平衡安全与性能，广泛硬件加速支持。
- GCM-AES-256：更高安全裕度，适用于高保密行业；需关注设备性能与功耗。
- GCM-AES-XPN-128/256：扩展到 64 位 PN，IV 基于 SSCI+PN 组合，适配 100G/400G 等高速长寿命链路。

## 6.2 选择维度与实践建议

- 安全等级：128 足以覆盖大部分场景；涉密/长寿命连接考虑 256。
- 带宽与寿命：高速/长时间无中断业务优先 XPN，避免 32 位 PN 快速溢出。
- 设备能力：优先选择具备 GCM 硬件加速的设备；关注 IV 生成与 PN 管理上的实现细节。
- 合规要求：对特定行业标准（如金融/政府）的套件白名单进行适配。

## 6.3 机密性偏移（Confidentiality Offset）

- 典型取值：0/30/50 字节；根据是否需要外部可见的分类字段（例如 VLAN）决定。
- 风险权衡：偏移越大，泄露元数据越多；偏移为 0 时隐私最好，但对运维诊断要求更高。

## 6.4 重键与密钥生命周期

- 触发策略：基于 PN 阈值、计时器或成员变更事件。
- 时延要求：新 SAK 1 秒内就绪，发送侧 1 帧内切换，接收侧双 SAK 并存以平滑过渡。
- 预留阈值：设置 `rekeyThreshold`（如达到 PN 的 70% 发出预警），保证有充足时间完成切换。
- 事件记录：记录每次重键的时间、参与者、耗时与异常，作为审计与回归参考。

## 6.5 密钥保护与管理面安全

- MKA 中，CKN/CAK 保护组内 SAK 分发；管理面使用安全通道（如 SNMPv3、SSH、TLS）。
- 严禁在日志/脚本中明文存放密钥；对备份与导出进行加密与访问控制。

## 6.6 组合示例

- 园区骨干：GCM-AES-128 + 偏移 30，观察模式一周后转严格；PN 阈值 60% 预警，80% 强制重键。
- 金融专线：GCM-AES-256 + XPN + 偏移 0；严格窗口与较短重键周期；启用全量审计。
- 数据中心互联：GCM-AES-XPN-128，按优先级分 SC，窗口适度放宽以容忍 LAG 乱序。

本篇给出了“选什么、怎么用”的方法论。下一篇将讲述如何把它们管起来，并看得见、控得住。

